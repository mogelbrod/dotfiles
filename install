#!/usr/bin/env ruby
# original script from
# <http://errtheblog.com/posts/89-huba-huba>
# with edits by mogelbrod <http://github.com/mogelbrod>

home = File.expand_path('~')

Dir['*'].each do |file|
  next if file =~ /install/
  if file =~ /fish/
    target = File.join(home, ".config/#{file}")
  else
    target = File.join(home, ".#{file}")
  end
  
  if File.exists?(target)
    puts " - #{file} (#{target}) already exists, skipping."
  else
    res = `ln -s #{File.expand_path file} #{target}`
    if $?.exitstatus != 0
      puts " ! #{target} could not be linked."
    else
      puts " + #{target} have been linked to #{file}."
    end
  end
end

# git push on commit
`echo 'git push' > .git/hooks/post-commit`
`chmod 755 .git/hooks/post-commit`
